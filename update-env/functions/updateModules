#!/usr/bin/env zsh
#function updateModules {
  typeset -a modules user_module_dirs
  zstyle -a ':prezto:load' pmodule 'modules'
  zstyle -a ':prezto:load' pmodule-dirs 'user_module_dirs'

  for module in "${modules[@]}"; do
    typeset -a locations=(${user_module_dirs:+${^user_module_dirs}/$module(-/FN)})
    if (( ${#locations} != 1 )); then
      continue
    fi

    typeset upgradeScript=${locations[-1]}/upgrade.zsh

    if [[ -s ${upgradeScript} ]]; then
      printf "${FX[bold]}${FG[blue]}=> %s${FG[none]}${FX[none]}\n" "Updating module ${module}"
      source "${upgradeScript}"
    fi
  done
#}