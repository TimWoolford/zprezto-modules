#function updateEnvironment {
    echo "Updating environment"
    git -C ${ZDOTDIR} pull origin ${DOTDIR_BRANCH:-master}
    git -C ${ZDOTDIR} submodule update --init --recursive --remote

    echo "Updating homebrew"
    brew update && brew upgrade
    brew tap homebrew/bundle && brew bundle --verbose --file=${ZDOTDIR}/Brewfile

    if ( [ -d ${ZDOTDIR}/ssh ] ); then
        echo "Adding SSH keys"
        for identityFile in `ls ${ZDOTDIR}/ssh/*_rsa`
        do
            chmod 600 ${identityFile}
            ssh-add -K ${identityFile}
        done
    fi

    setLinks

    zcompdump="${ZDOTDIR:-$HOME}/.zcompdump"
    rm -rf $zcompdump ${zcompdump}.zwc ${XDG_CACHE_HOME:-$HOME/.cache}/prezto/zcomp{cache,dump}
    autoload -Uz compinit

    $(date +%s >| ~/.environment_lastupdate)
    echo "\n\n$FX[bold]$FG[yellow]You will need to reopen a terminal session to benefit from any updates$FG[none]$FX[none]"
#}
